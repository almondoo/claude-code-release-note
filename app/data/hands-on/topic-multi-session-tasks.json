{
  "topicId": "multi-session-tasks",
  "title": "Tasks を複数セッションで実行する",
  "difficulty": "easy",
  "estimatedTime": "20分",
  "steps": [
    {
      "id": "step-1",
      "label": "STEP 1",
      "title": "Tasks 機能の概要",
      "description": "Claude Code のタスク管理機能を理解します。",
      "blocks": [
        { "type": "highlight", "variant": "info", "title": "「セッション」とは？", "content": "このガイドでの「セッション」は、ターミナルで claude コマンドを起動してから終了するまでの1回の会話を指します。/exit で終了するか、ターミナルを閉じるとセッションが終わります。" },
        { "type": "text", "content": "Claude Code のタスク管理機能を使うと、複数のセッションにまたがる大規模な作業を構造化して管理できます。タスクはファイルとして保存されるため、セッションを閉じても進捗が保持されます。" },
        { "type": "highlight", "variant": "tip", "title": "このハンズオンの読み方", "content": "本ガイドでは仕組みを理解しやすくするために内部ツール名（TaskCreate, TaskList など）を記載していますが、実際の操作では自然言語で Claude Code に指示するだけで OK です。" },
        { "type": "text", "content": "こんなときに使えます:" },
        { "type": "list", "items": [
          "1セッションでは完了しない大きな実装",
          "計画的に段階を分けて進めたい作業",
          "複数日にわたるリファクタリングやマイグレーション",
          "途中で中断して翌日に再開したい作業"
        ]},
        { "type": "highlight", "variant": "warning", "title": "前提条件", "content": "Claude Code がインストールされ、プロジェクトディレクトリで正常に起動できることが必要です。" }
      ]
    },
    {
      "id": "step-2",
      "label": "STEP 2",
      "title": "作業計画をタスクに分解する",
      "description": "大きな作業を管理可能なタスクに分割します。",
      "blocks": [
        { "type": "text", "content": "まず、実現したい目標を Claude Code に伝え、タスクへの分割を依頼します。各タスクは1セッション（数十分〜1時間程度）で完了できるサイズが理想的です。" },
        { "type": "codeBlock", "language": "text", "code": "# 指示例:\n「ユーザー認証機能の実装を計画してください。\n以下のステップに分けてタスクリストを作ってください:\n1. データベーススキーマとマイグレーション\n2. 認証API（ログイン・ログアウト・リフレッシュ）\n3. ミドルウェアとガード\n4. フロントエンドのログインフォーム\n5. テスト」", "caption": "Claude Code が自動でタスクリストを作成します" },
        { "type": "highlight", "variant": "warning", "title": "重要: タスクの説明は詳しく", "content": "「認証APIを作る」だけでは不十分です。次のセッションの Claude Code は前回の会話を覚えていないため、タスクの説明文だけを頼りに作業します。使用するライブラリ、ファイルパス、設計方針なども含めるよう指示しましょう。" },
        { "type": "highlight", "variant": "tip", "title": "分割サイズの目安", "content": "1タスク = ファイル数3〜5個の変更、または1つの明確な機能単位が目安です。大きすぎるとセッション内で完了しない可能性があり、小さすぎると管理のオーバーヘッドが増えます。" }
      ]
    },
    {
      "id": "step-3",
      "label": "STEP 3",
      "title": "タスクの依存関係を設定する",
      "description": "タスク間の実行順序を定義します。",
      "blocks": [
        { "type": "text", "content": "タスクに依存関係を設定すると、前提タスクが完了するまで後続タスクが「ブロック」された状態になります。これにより、例えば「DB設計が終わるまでAPIは作らない」という順序を保証できます。" },
        { "type": "codeBlock", "language": "text", "code": "# 依存関係の指示例:\n「タスクの依存関係を設定してください:\n- 認証APIは、DBスキーマが完了してから開始\n- ミドルウェアは、認証APIが完了してから開始\n- フロントエンドは、認証APIが完了してから開始\n- テストは、ミドルウェアとフロントエンドの両方が完了してから開始」\n\n# 結果のイメージ:\n#1 DB ──→ #2 API ──→ #3 ミドルウェア ─┐\n                  └──→ #4 フロントエンド ─┤→ #5 テスト", "caption": "自然言語で指示するだけ。内部的に依存関係が自動設定されます" },
        { "type": "highlight", "variant": "tip", "title": "依存関係は必須ではない", "content": "すべてのタスクに依存関係が必要なわけではありません。順番に関係なく進められるタスクは、依存関係なしで作成して問題ありません。" }
      ]
    },
    {
      "id": "step-4",
      "label": "STEP 4",
      "title": "セッション 1: 最初のタスクに着手する",
      "description": "最初のセッションでタスクを開始し、完了させます。",
      "blocks": [
        { "type": "text", "content": "タスクリストが準備できたら、最初のタスクに着手します。Claude Code に「タスクリストの最初のタスクから始めてください」と指示するだけです。" },
        { "type": "codeBlock", "language": "text", "code": "# セッション1での指示例:\n「タスクリストを確認して、最初のタスクから始めてください」\n\n# Claude Code が自動で行うこと:\n1. タスク一覧を取得\n2. 着手可能な最初のタスクを選択\n3. そのタスクを「作業中」に変更\n4. 実装作業を実施\n5. 完了したら「完了」に変更\n6. 次のタスクがあれば続行", "caption": "タスクの状態管理はすべて自動です" },
        { "type": "highlight", "variant": "info", "title": "1セッションで複数タスク完了も可能", "content": "セッションの時間に余裕があれば、1つ目のタスク完了後に自動で次のタスクに進みます。「今日はここまで」と思ったら /exit でセッションを終了してください。" },
        { "type": "highlight", "variant": "tip", "title": "セッション終了前に", "content": "セッションを終える前に「現在のタスク進捗を見せてください」と聞いておくと、どこまで完了したかを自分で把握できます。次のセッションはこの会話を覚えていませんが、タスクリストの状態（完了/未完了）は自動で引き継がれます。" }
      ]
    },
    {
      "id": "step-5",
      "label": "STEP 5",
      "title": "セッション 2: 新しいセッションでタスクを引き継ぐ",
      "description": "新しいセッションでタスクリストを確認し、次のタスクに着手します。",
      "blocks": [
        { "type": "highlight", "variant": "warning", "title": "重要: 新しいセッションは前回の会話を覚えていない", "content": "新しいセッションの Claude Code は、前回のセッションで何を話したか一切知りません。唯一の手がかりはタスクリスト（とその説明文）だけです。だからこそ STEP 2 でタスクの説明を詳しく書くことが重要です。" },
        { "type": "text", "content": "同じプロジェクトディレクトリで新しい claude セッションを起動し、タスクリストを確認するよう指示します。新しいセッションは前回の会話を知らないので、「続きを再開」ではなく「タスクリストを見て次のタスクに着手」と伝えるのがポイントです。" },
        { "type": "codeBlock", "language": "text", "code": "# セッション2での指示例:\n「タスクリストを確認して、次の未完了タスクに取りかかってください」\n\n# Claude Code が自動で行うこと:\n1. タスク一覧を取得し、完了済み/未完了を確認\n2. 着手可能な次のタスクを選択\n3. タスクの説明文を読んで、作業に必要な情報を把握\n4. 作業を開始", "caption": "同じプロジェクトディレクトリで claude を起動してください" },
        { "type": "highlight", "variant": "tip", "title": "CLAUDE.md との併用", "content": "プロジェクトの設計方針や技術スタック情報を CLAUDE.md（プロジェクトルートの .claude/CLAUDE.md）に書いておくと、どのセッションでも共通のコンテキストとして読み込まれます。タスク説明と合わせて活用しましょう。" }
      ]
    },
    {
      "id": "step-6",
      "label": "STEP 6",
      "title": "全タスク完了と振り返り",
      "description": "すべてのタスクが完了したら、成果を確認します。",
      "blocks": [
        { "type": "text", "content": "全タスクが完了したら、最終確認を指示します。" },
        { "type": "codeBlock", "language": "text", "code": "# 最終確認の指示例:\n「全タスクの完了状態を確認し、\n型チェックとテストを実行してください」\n\n# 結果例:\nTask #1: DB スキーマ        ✓ 完了\nTask #2: 認証 API           ✓ 完了\nTask #3: ミドルウェア       ✓ 完了\nTask #4: フロントエンド     ✓ 完了\nTask #5: テスト             ✓ 完了", "caption": "全タスクの完了を確認したら、コードレビューやPR作成に進みましょう" },
        { "type": "highlight", "variant": "info", "title": "まとめ: 全体のフロー", "content": "① 作業計画をタスクに分割 → ② 依存関係を設定 → ③ セッションごとにタスクを着手・完了 → ④ 新しいセッションで「タスクリストを確認して次へ」→ ⑤ 全タスク完了を確認。ポイントはタスク説明の充実です。" },
        { "type": "highlight", "variant": "tip", "title": "うまくいかないとき", "content": "新しいセッションで Claude Code が文脈を理解できない場合は、タスクの説明が不足しています。「このタスクの説明を詳しく更新してください。使用するファイルパス、ライブラリ、設計方針を含めてください」と指示して説明を充実させましょう。" }
      ]
    }
  ],
  "summary": [
    "「セッション」= claude コマンドの起動から終了までの1回の会話",
    "タスクはファイルとして永続化され、セッションをまたいで保持される",
    "タスクの説明文を詳しく書くことが、セッション間の引き継ぎの鍵",
    "依存関係を設定するとタスクの実行順序を保証できる",
    "新しいセッションでは「タスクリストを確認して次のタスクへ」と指示するだけで引き継げる",
    "CLAUDE.md との併用で、全セッション共通のコンテキストを提供できる"
  ]
}
