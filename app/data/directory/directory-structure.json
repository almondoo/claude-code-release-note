{
  "sections": [
    {
      "id": "global",
      "name": "グローバル設定",
      "basePath": "~/.claude/",
      "description": "ユーザー全体に適用される設定。全プロジェクトで共通して使う設定やカスタマイズをここに配置する。",
      "entries": [
        {
          "path": "settings.json",
          "type": "file",
          "name": "グローバル設定",
          "description": "ユーザー全体の権限・ツール許可・フック設定",
          "detail": "全プロジェクトに適用される基本設定ファイル。permissions.allow / permissions.deny / permissions.ask でツールの許可・確認・拒否パターンを定義する。フック設定（hooks）、サンドボックス設定（sandbox）、アトリビューション設定（attribution）、プラグイン設定（enabledPlugins）、MCP 制御（enableAllProjectMcpServers 等）、UI 設定（spinnerVerbs, statusLine 等）も記述可能。モデル関連設定（model, availableModels で使用可能モデルを制限、alwaysThinkingEnabled で拡張思考をデフォルト有効化）、language で Claude の応答言語を指定できる。\n\nプロジェクト設定（.claude/settings.json）との関係では、deny → ask → allow の順で全階層の設定がマージされて評価される。JSON スキーマ（$schema: https://json.schemastore.org/claude-code-settings.json）を設定するとエディタで自動補完が効く。",
          "usage": "permissions.deny に \"Bash(rm -rf *)\" のようなパターンを追加すると、全プロジェクトで危険なコマンドをブロックできる。sandbox.enabled: true でサンドボックスを有効化し、attribution でコミット・PR のアトリビューションをカスタマイズできる。env オブジェクトで全セッション共通の環境変数を定義することも可能。",
          "bestPractice": "deny ルールで .env や秘密鍵など機密ファイルへのアクセスをブロックし、allow は最小限に。$schema を設定してエディタ補完を活用する。プロジェクト設定と競合しないよう、グローバルでは共通設定のみ定義する。",
          "vcs": false,
          "recommended": "recommended"
        },
        {
          "path": "settings.local.json",
          "type": "file",
          "name": "ローカル専用設定",
          "description": "同期しないローカル専用設定",
          "detail": "settings.json と同じ JSON 形式だが、このマシンにのみ適用される設定。クラウド同期やバックアップの対象外にしたい設定に使う。settings.json と settings.local.json の両方が存在する場合、両方の設定がマージされて適用される。",
          "usage": "会社の Mac と個人の Mac で異なるフック設定を使いたい場合や、特定のマシンでだけ有効にしたいツール許可がある場合に便利。",
          "bestPractice": "マシン固有の設定のみに使い、チームで共有すべき設定は settings.json に書く。環境差分の管理が目的なので、設定は最小限に留める。",
          "vcs": false,
          "recommended": "optional"
        },
        {
          "path": "CLAUDE.md",
          "type": "file",
          "name": "グローバル指示ファイル",
          "description": "全プロジェクト共通の指示（メモリファイル）",
          "detail": "すべてのプロジェクトで Claude が自動的に読み込む指示ファイル。個人的なコーディングスタイルの好みや、常に適用したいルールを記載する。Claude はこのファイルの内容をシステムプロンプトの一部として毎回読み込むため、短く具体的に書くのが効果的。\n\nこのファイルが大きくなりすぎるとコンテキストウィンドウを圧迫する。目安として 200 行以内に収め、それ以上になったら rules/ ディレクトリでモジュラー化するのが推奨。@path/to/file 記法で他のファイルをインポートすることも可能（再帰5段階まで）。初回のインポートでは承認ダイアログが表示される。",
          "usage": "記載例：「コミットメッセージは日本語で書く」「変数名はキャメルケースを使う」「console.log ではなく構造化ロギングを使う」など。",
          "bestPractice": "200行以内に収め、肥大化したら rules/ で分割する。曖昧な指示より「2スペースインデント使用」のような具体的・再現可能な指示を書く。",
          "vcs": false,
          "recommended": "recommended"
        },
        {
          "path": "commands/",
          "type": "directory",
          "name": "グローバルスラッシュコマンド",
          "description": "全プロジェクトで使えるカスタムスラッシュコマンド（レガシー）",
          "detail": "このディレクトリに .md ファイルを配置すると、どのプロジェクトでもスラッシュコマンドとして呼び出せるカスタムコマンドになる。ファイル名がそのままコマンド名になる（例: review.md → /review）。Markdown ファイルの中身がそのままプロンプトとして Claude に送信される。$ARGUMENTS プレースホルダーを使うと、コマンド呼び出し時の引数を埋め込める。サブディレクトリも可能で、commands/db/migrate.md なら /db:migrate で呼び出せる。\n\n現在は skills/ の使用が推奨されている。commands/ のファイルは引き続き動作するが、skills/ は補助ファイルやフロントマター設定など追加機能を提供する。同名のスキルとコマンドがある場合、スキルが優先される。",
          "usage": "コードレビュー用プロンプト、リファクタリング手順、テスト生成テンプレートなど、繰り返し使うワークフローをコマンド化する。",
          "bestPractice": "新規作成は skills/ を推奨。既存の commands/ ファイルはそのまま動作する。複雑なワークフローは skills/ に移行すると補助ファイルやフロントマター設定が使える。",
          "vcs": false,
          "recommended": "optional"
        },
        {
          "path": "agents/",
          "type": "directory",
          "name": "グローバルカスタムエージェント",
          "description": "ユーザーレベルのカスタムサブエージェント",
          "detail": "独立したコンテキストウィンドウで動く特化型 AI エージェントを定義するディレクトリ。各エージェントは .md ファイルで定義し、YAML フロントマターで動作を設定できる。\n\nフロントマター: name（識別名）、description（用途の説明）、tools / disallowedTools（ツール許可・拒否）、model（sonnet / opus / haiku / inherit）、permissionMode（default / acceptEdits / dontAsk / bypassPermissions / plan / delegate）、maxTurns（最大ターン数）、skills（プリロードするスキル）、mcpServers（MCP サーバー）、hooks（ライフサイクルフック）、memory（永続メモリスコープ: user / project / local）。Claude が Task ツールを使うとき、ここに定義されたエージェントが subagent_type の選択肢として自動的に表示される。",
          "usage": "「Read と Grep だけ使える読み取り専用リサーチャー」や「Bash も使える自動テストランナー」といった特化型エージェントを作れる。memory: user を設定すると、エージェントが会話をまたいで学習した知識を ~/.claude/agent-memory/ に蓄積する。/agents コマンドで対話的に管理も可能。",
          "bestPractice": "tools / disallowedTools で使えるツールを最小限に制限し、最小権限の原則を守る。description を詳しく書くと Claude が適切に委譲できる。",
          "vcs": false,
          "recommended": "advanced"
        },
        {
          "path": "skills/<skill-name>/SKILL.md",
          "type": "file",
          "name": "グローバルスキル",
          "description": "ユーザーレベルの再利用可能なスキル",
          "detail": "SKILL.md と補助ファイルで構成される再利用可能なプロンプト・ワークフロー。Agent Skills オープン標準に準拠。SKILL.md の YAML フロントマターで動作を設定できる。\n\nフロントマター: name（表示名）、description（用途の説明）、argument-hint（引数ヒント）、disable-model-invocation（Claude の自動呼び出しを禁止）、user-invocable（/ メニュー非表示）、allowed-tools（ツール許可）、model（使用モデル）、context（fork でサブエージェント実行）、agent（context: fork 時のエージェント型）、hooks（スキルのライフサイクルフック）。$ARGUMENTS / $ARGUMENTS[N] / $N で引数を受け取り、${CLAUDE_SESSION_ID} でセッション ID を利用でき、!`command` で動的コンテキストを注入できる。",
          "usage": "context: fork + agent: Explore でリサーチスキルを作ったり、disable-model-invocation: true でデプロイスキルをユーザー専用にしたりできる。補助ファイル（テンプレート、スクリプト等）を同じディレクトリに配置して参照可能。",
          "bestPractice": "SKILL.md は 500 行以内に抑え、詳細なリファレンスは別ファイルに分離する。description を書いて Claude が自動的に見つけられるようにする。",
          "vcs": false,
          "recommended": "advanced"
        },
        {
          "path": "rules/",
          "type": "directory",
          "name": "グローバルルール",
          "description": "全プロジェクト共通のルール（トピック別 .md ファイル）",
          "detail": "CLAUDE.md を分割してモジュラー管理するためのディレクトリ。Claude はこのディレクトリ内のすべての .md ファイルを自動的に読み込む。CLAUDE.md が肥大化したときの分割先として使うのが主なユースケース。サブディレクトリでの整理も可能。\n\npaths フロントマターを使うとファイルパス条件付きルールも定義でき、「*.test.ts ファイルを編集するときだけ適用されるテストルール」のような使い方ができる。ユーザーレベルのルールはプロジェクトルールより低い優先度で読み込まれる。",
          "usage": "1ファイル1トピック（例: coding-style.md, git-workflow.md, naming-conventions.md）で管理し、全プロジェクトに適用する。",
          "bestPractice": "1ファイル1トピックで管理し、ファイル名でルールの内容が分かるようにする。paths フロントマターでスコープを絞ると不要な読み込みを減らせる。",
          "vcs": false,
          "recommended": "optional"
        },
        {
          "path": "plans/",
          "type": "directory",
          "name": "プランファイル",
          "description": "プランファイルのデフォルト保存場所",
          "detail": "Claude が plan モード（EnterPlanMode）で作成したプランが保存されるデフォルトの場所。プランファイルは Markdown 形式で、実装手順やファイル変更の概要が記録される。保存されたプランは後から参照でき、長期的なタスクの進捗管理にも使える。自動的に作成・管理されるため、手動で触る必要はほとんどない。",
          "usage": "settings.json の plansDirectory 設定でこの保存先を変更できる。プロジェクトごとに別のディレクトリを指定したい場合は、プロジェクトの settings.json で上書きする。",
          "bestPractice": "自動管理されるため手動編集は不要。保存先を変えたい場合は settings.json の plansDirectory で指定する。",
          "vcs": false,
          "recommended": "optional"
        },
        {
          "path": "projects/<project>/memory/",
          "type": "directory",
          "name": "オートメモリ",
          "description": "Claude が自動的に保存するプロジェクト別の学習メモ",
          "detail": "Claude がセッション中に自動的に学んだパターン・知見・コマンド・好みなどを記録するディレクトリ。プロジェクトごとに独立した領域が作られ、<project> はリポジトリルートから導出される。git worktree ごとに別のメモリディレクトリが使われる。\n\nMEMORY.md がエントリポイントで、毎セッションの起動時に先頭 200 行がシステムプロンプトに読み込まれる。トピックファイル（debugging.md, patterns.md 等）は起動時には読み込まれず、Claude が必要に応じてオンデマンドで読む。CLAUDE_CODE_DISABLE_AUTO_MEMORY=1 で無効化、=0 で強制有効化。",
          "usage": "/memory コマンドでエディタからメモリファイルを編集できる。「pnpm を使うことを覚えて」のように Claude に直接依頼してメモリに保存させることも可能。",
          "bestPractice": "MEMORY.md は 200 行以内に収め、詳細はトピックファイルに分離する。定期的に /memory で整理し、古い情報を削除する。",
          "vcs": false,
          "recommended": "recommended"
        },
        {
          "path": "agent-memory/<agent-name>/",
          "type": "directory",
          "name": "エージェントメモリ（user スコープ）",
          "description": "エージェントの永続メモリ（全プロジェクト共通）",
          "detail": "エージェントが会話をまたいで記憶を保持するためのディレクトリ。user スコープのため全プロジェクトで共有される。エージェント定義で memory: user と指定したエージェントが、ここに MEMORY.md などのファイルを書き込む。エージェントは過去の失敗や学習したパターンをここに記録し、次回の会話で参照する。これにより、同じ間違いを繰り返さずに改善していく振る舞いが可能になる。",
          "usage": "ディレクトリ名はエージェント名に対応する（例: code-reviewer エージェントなら agent-memory/code-reviewer/）。手動で編集することも可能だが、基本的にはエージェントが自動管理する。",
          "bestPractice": "基本的にエージェントの自動管理に任せる。手動で編集する場合は、エージェントが書き込む形式に合わせて MEMORY.md を更新する。",
          "vcs": false,
          "recommended": "optional"
        },
        {
          "path": "teams/",
          "type": "directory",
          "name": "エージェントチーム設定",
          "description": "エージェントチームの設定ファイル",
          "detail": "複数のエージェントが協調して作業するエージェントチーム機能の設定ディレクトリ。各チームの config.json にメンバー情報（name, agentId, agentType）が格納される。CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1 で有効化。\n\nチームはリーダー（TeamCreate で作成）とメンバー（Task ツールで team_name を指定してスポーン）で構成される。リーダーがタスクリストでタスクを管理し、メンバーに割り当てる。メンバー間は SendMessage で直接メッセージをやり取りする。",
          "usage": "サブエージェントとは異なり、エージェントチームは複数のセッションにまたがって協調する。フロントエンド・バックエンド・テストを並行で進めるなど、大規模タスクの並列化に有効。",
          "bestPractice": "タスクを明確に分割し、依存関係を TaskUpdate の addBlockedBy で管理する。teammateMode 設定で表示方法を auto / in-process / tmux から選べる。",
          "vcs": false,
          "recommended": "advanced"
        },
        {
          "path": "tasks/",
          "type": "directory",
          "name": "タスクリスト",
          "description": "エージェントチームのタスクリスト保存場所",
          "detail": "エージェントチーム機能で使用されるタスクリストの保存ディレクトリ。チームごとにサブディレクトリが作られ、タスクの状態（pending / in_progress / completed）や依存関係が管理される。\n\nCLAUDE_CODE_TASK_LIST_ID 環境変数で複数セッション間でタスクリストを共有することも可能。TaskCreate / TaskUpdate / TaskList ツールで操作する。",
          "usage": "エージェントチーム使用時に自動的に作成・管理される。手動で触る必要はほとんどない。",
          "bestPractice": "自動管理に任せる。タスクの状態管理は TaskUpdate ツールで行い、直接 JSON を編集しない。",
          "vcs": false,
          "recommended": "advanced"
        },
        {
          "path": "keybindings.json",
          "type": "file",
          "name": "キーバインド設定",
          "description": "Claude Code のキーバインド設定",
          "detail": "Claude Code CLI のショートカットキーをカスタマイズするための設定ファイル。デフォルトのキーバインドを上書きしたり、新しいキーバインドを追加できる。JSON 形式で、各エントリは key（キーの組み合わせ）、command（実行するコマンド）、when（条件）で構成される。Chord バインディング（2段階キー入力）にも対応しており、例えば Ctrl+K → Ctrl+C のような連続入力も設定可能。",
          "usage": "/keybindings-help コマンドで設定のヘルプを確認できる。よく使うカスタマイズ例: 送信キーの変更、新規会話の開始ショートカット、モード切り替えなど。",
          "bestPractice": "/keybindings-help で設定ヘルプを確認してからカスタマイズする。デフォルトのキーバインドと競合しないよう注意する。",
          "vcs": false,
          "recommended": "optional"
        }
      ],
      "bestPractices": [
        "個人的なコーディングスタイルの好みは ~/.claude/CLAUDE.md に記載し、プロジェクト固有の指示と分離する",
        "permissions.deny で .env や秘密鍵など機密ファイルへのアクセスをブロックするのが推奨",
        "グローバル CLAUDE.md が大きくなりすぎたら rules/ でモジュラー化する",
        "settings.json に $schema を設定するとエディタでの自動補完が有効になる"
      ]
    },
    {
      "id": "project-root",
      "name": "プロジェクトルート",
      "basePath": "<project>/",
      "description": "プロジェクトのルートディレクトリ直下に配置するファイル。チームで共有するものとローカル専用のものがある。",
      "entries": [
        {
          "path": "CLAUDE.md",
          "type": "file",
          "name": "プロジェクト指示ファイル",
          "description": "プロジェクトルートの指示ファイル（チームと共有）",
          "detail": "プロジェクト固有のビルドコマンド、テストコマンド、コーディング規約、アーキテクチャの説明などを記載するファイル。チームメンバー全員が同じ指示を受け取れるよう VCS にコミットする。曖昧な指示（「コードを綺麗に書く」）より、具体的な指示（「関数は30行以内」）のほうが効果的。\n\n@path/to/file 記法でファイルをインポート可能（再帰5段階まで）。これを使うと、既存の CONTRIBUTING.md やコーディング規約ドキュメントを直接参照できる。マークダウン見出し（# コマンド、# アーキテクチャ 等）でセクション分けすると、Claude が構造を理解しやすくなる。.claude/CLAUDE.md にも同名ファイルを置ける。両方存在する場合はどちらも読み込まれる。サブディレクトリの CLAUDE.md は、Claude がそのディレクトリのファイルを読んだときにオンデマンドで読み込まれる。",
          "usage": "記載例：「pnpm run test で全テスト実行」「API エンドポイントは /api/v2/ プレフィックスを使う」「エラーハンドリングは Result 型パターンを使う」など。/init コマンドで自動生成することも可能。",
          "bestPractice": "ビルド・テスト・リントのコマンドを必ず記載する。@記法で既存の CONTRIBUTING.md を参照し、情報の重複を避ける。見出しでセクション分けして構造化する。",
          "vcs": true,
          "recommended": "recommended"
        },
        {
          "path": "CLAUDE.local.md",
          "type": "file",
          "name": "個人用プロジェクトメモリ",
          "description": "個人用メモリ（自動で .gitignore に追加される）",
          "detail": "個人的なメモや、自分だけに適用したい指示を記載するファイル。初回作成時に自動的に .gitignore に追加されるため、チームメンバーには共有されない。/memory コマンドで Claude が自動的にこのファイルに学習内容を記録することもある。プロジェクト固有の個人メモとして活用すると、セッション間で作業状態を維持できる。\n\n複数の git worktree を使用している場合、CLAUDE.local.md は1つの worktree にしか存在しない。全 worktree で共有したい個人設定は ~/.claude/my-project-instructions.md に書いて @記法でインポートするのが推奨。",
          "usage": "記載例：「自分は TypeScript 初心者なので型の説明を丁寧にしてほしい」「このプロジェクトでは feature/xxx ブランチで作業中」「デバッグ時は console.log を使ってOK」など、個人的なコンテキストや好みを書く。",
          "bestPractice": "個人的なコンテキストや好みのみを記載し、チーム共有すべき情報は CLAUDE.md に書く。git worktree を使う場合はホームディレクトリの @インポートで共有する。",
          "vcs": false,
          "recommended": "optional"
        },
        {
          "path": ".mcp.json",
          "type": "file",
          "name": "MCP サーバー設定",
          "description": "MCP（Model Context Protocol）サーバーの設定ファイル",
          "detail": "プロジェクトで使用する MCP サーバーの接続情報を定義するファイル。MCP サーバーは Claude に外部ツール（データベース接続、API 呼び出し、ブラウザ操作など）を提供する仕組み。JSON 形式で mcpServers オブジェクトの中にサーバー定義を記述する。3つのトランスポートに対応: HTTP（推奨）、SSE（非推奨）、stdio。環境変数の展開（${VAR} / ${VAR:-default}）を command, args, env, url, headers で使用可能。\n\nユーザーレベルの MCP 設定は ~/.claude.json に書くが、プロジェクト固有のものはここに定義する。チームで共有するために VCS にコミットするのが推奨。プロジェクトスコープのサーバーは初回使用時に承認ダイアログが表示される。",
          "usage": "claude mcp add --scope project で追加。認証情報は直接書かず、環境変数展開（${API_KEY}）や apiKeyHelper スクリプトで動的に取得する。OAuth 2.0 認証は /mcp コマンドでブラウザログインフローを実行。",
          "bestPractice": "API キーは ${VAR} で環境変数展開するか、apiKeyHelper で動的に取得する。HTTP トランスポートを推奨（SSE は非推奨）。チーム共有するために VCS にコミットする。",
          "vcs": true,
          "recommended": "optional"
        }
      ],
      "bestPractices": [
        "CLAUDE.md にはよく使うコマンド（ビルド、テスト、リント）を必ず記載して、Claude の繰り返し検索を避ける",
        "具体的に書く：「2スペースインデント使用」のように明確な指示が効果的（「コードを適切にフォーマット」は曖昧）",
        "マークダウン見出しでグループ化し、箇条書きで個別指示を記述すると構造化されて読みやすい",
        "定期的に見直して、プロジェクトの進化に合わせて更新する"
      ]
    },
    {
      "id": "project-claude",
      "name": "プロジェクト設定",
      "basePath": "<project>/.claude/",
      "description": "プロジェクト固有の Claude Code 設定ディレクトリ。チーム共有設定とローカル設定を分けて管理する。",
      "entries": [
        {
          "path": "settings.json",
          "type": "file",
          "name": "プロジェクト共有設定",
          "description": "チームで共有するプロジェクト設定（VCS にコミット）",
          "detail": "プロジェクト全体で統一したい権限設定やフックを定義するファイル。VCS にコミットしてチーム全員に同じルールを適用する。設定の評価順序は deny → ask → allow で、全階層（Managed → Local → Project → User）の設定がマージされる。deny ルールは常に最優先。\n\nここで deny したものは、ユーザー設定で allow されていてもブロックされる。逆に allow したツールでも、ユーザーのグローバル設定で deny されていればブロックされない（deny は全階層で最優先）。",
          "usage": "「このプロジェクトでは本番DBへの直接接続を禁止」のような安全策を定義できる。フック設定も可能で、例えば PreToolUse フックで Bash コマンド実行前にリンターを走らせたり、PostToolUse フックで Write ツール使用後に自動フォーマットをかけるといった自動化ができる。",
          "bestPractice": "deny ルールを最優先で定義し、チームの安全策を確実に適用する。フックで自動フォーマットやリンターを設定するとコード品質を自動維持できる。",
          "vcs": true,
          "recommended": "recommended"
        },
        {
          "path": "settings.local.json",
          "type": "file",
          "name": "プロジェクトローカル設定",
          "description": "個人用のプロジェクト設定（自動 gitignore）",
          "detail": "自分だけに適用したいプロジェクト固有の設定ファイル。初回作成時に自動的に .gitignore に追加される。settings.json と同じ JSON 形式で、permissions や hooks を定義できる。設定の優先順位では Local レベル（レベル3）として評価され、Project レベル（レベル4）より優先される。",
          "usage": "個人的に追加で許可したいツール、自分の環境でだけ動かしたいフック、デバッグ用の設定など。チームの設定を壊さずに個人的なカスタマイズができる。",
          "bestPractice": "チームの settings.json を壊さない個人カスタマイズのみに使う。デバッグ用の一時的な設定もここに書き、作業完了後は整理する。",
          "vcs": false,
          "recommended": "optional"
        },
        {
          "path": "CLAUDE.md",
          "type": "file",
          "name": "プロジェクト指示（.claude 内）",
          "description": "プロジェクト固有の指示（.claude/ 内に置くことも可能）",
          "detail": "プロジェクトルートの CLAUDE.md と同等の機能を持つファイル。.claude/ ディレクトリ内に置くことで、プロジェクトルートをすっきり保てる。両方（ルートの CLAUDE.md と .claude/CLAUDE.md）が存在する場合はどちらも読み込まれる。",
          "usage": "チームの目に触れやすくしたいならルート直下、設定ファイル群と一緒に管理したいなら .claude/ 内に配置。ルートの CLAUDE.md と内容を分担させることも可能（例: ルートには概要とコマンド一覧、.claude/CLAUDE.md にはアーキテクチャの詳細説明）。",
          "bestPractice": "ルートの CLAUDE.md と内容を分担し、重複を避ける。例: ルートにはコマンド一覧、.claude/ にはアーキテクチャ詳細という使い分けが効果的。",
          "vcs": true,
          "recommended": "optional"
        },
        {
          "path": "commands/",
          "type": "directory",
          "name": "プロジェクトスラッシュコマンド",
          "description": "プロジェクト固有のカスタムスラッシュコマンド（レガシー）",
          "detail": "このディレクトリに .md ファイルを配置するとスラッシュコマンドとして呼び出せるカスタムコマンドになる。プロジェクト固有のワークフローをコマンド化してチームで共有するのに最適。$ARGUMENTS プレースホルダーで引数を受け取れる。サブディレクトリで整理も可能。VCS にコミットすることで、チーム全員が同じコマンドセットを使える。\n\n現在は skills/ の使用が推奨されている。commands/ のファイルは引き続き動作し、同じフロントマター設定もサポートする。同名のスキルとコマンドがある場合、スキルが優先される。",
          "usage": "例: deploy.md でデプロイ手順を実行、review-checklist.md でレビュー観点を確認。",
          "bestPractice": "新規作成は skills/ を推奨。チーム全員が使うワークフローは VCS にコミットして共有する。",
          "vcs": true,
          "recommended": "optional"
        },
        {
          "path": "agents/",
          "type": "directory",
          "name": "プロジェクトカスタムエージェント",
          "description": "プロジェクト固有のカスタムサブエージェント",
          "detail": "プロジェクトに特化したエージェントを定義するディレクトリ。各エージェントは .md ファイルで定義し、YAML フロントマターで動作を設定できる。フロントマター: name、description、tools / disallowedTools、model、permissionMode、maxTurns、skills（プリロード）、mcpServers、hooks、memory。\n\nClaude が Task ツールを使うとき、ここに定義されたエージェントが subagent_type の選択肢として自動表示される。VCS にコミットすることで、チーム全員が同じエージェントセットを利用でき、プロジェクト固有のベストプラクティスを自動化できる。/agents コマンドで対話的に作成・管理も可能。",
          "usage": "特定のフレームワークに精通した「フロントエンド専門エージェント」や、セキュリティ観点でのコードレビューに特化した「セキュリティレビューエージェント」を定義できる。skills フィールドでスキルをプリロードし、memory: project でプロジェクト知識を蓄積させる。",
          "bestPractice": "tools / disallowedTools でスコープを制限する。description を詳しく書くと Claude が適切に委譲できる。汎用エージェントはグローバル、プロジェクト特化はここに配置。",
          "vcs": true,
          "recommended": "optional"
        },
        {
          "path": "skills/<skill-name>/SKILL.md",
          "type": "file",
          "name": "プロジェクトスキル",
          "description": "プロジェクト固有のスキル",
          "detail": "プロジェクトに特化した再利用可能なワークフローを定義する。SKILL.md に処理内容を記述し、補助ファイル（テンプレート、設定ファイル等）を同じディレクトリに配置する。フロントマター: name、description、argument-hint、disable-model-invocation、user-invocable、allowed-tools、model、context（fork でサブエージェント実行）、agent、hooks。\n\n$ARGUMENTS / $ARGUMENTS[N] / $N で引数、${CLAUDE_SESSION_ID} でセッション ID、!`command` で動的コンテキストを注入できる。VCS にコミットしてチームで共有できる。サブディレクトリの .claude/skills/ も自動検出される（モノレポ対応）。",
          "usage": "例えば「新しい API エンドポイントを追加する」スキルを定義し、テンプレートを補助ファイルとして含めることで、一貫性のあるコード生成が可能になる。hooks フロントマターで PreToolUse フックを定義してセキュリティチェックを組み込むこともできる。",
          "bestPractice": "SKILL.md は 500 行以内に収め、補助ファイルを活用する。チームの定型ワークフローをスキル化して品質を標準化する。",
          "vcs": true,
          "recommended": "optional"
        },
        {
          "path": "rules/",
          "type": "directory",
          "name": "モジュラールール",
          "description": "トピック別 .md ファイルでルールを分割管理",
          "detail": "CLAUDE.md を分割してモジュラー管理するためのディレクトリ。Claude はこのディレクトリ内のすべての .md ファイルを自動的に読み込む。サブディレクトリでグループ化も可能（例: frontend/, backend/, infra/）。大規模プロジェクトでは、チーム別にルールを分けて管理するのが効果的。\n\npaths フロントマターを使うとファイルパス条件付きルールを定義できる。例えば testing.md のフロントマターに paths: [\"**/*.test.ts\", \"**/*.spec.ts\"] と書くと、テストファイルを編集するときだけそのルールが適用される。ブレース展開（{ts,tsx}）も対応。シンボリックリンクを使って、複数プロジェクト間で共通ルールを共有することも可能（循環リンクは自動検出）。",
          "usage": "1ファイル1トピック（例: testing.md, api-design.md, error-handling.md）で管理し、保守性と可読性を向上させる。",
          "bestPractice": "1ファイル1トピック。paths フロントマターでファイルパス条件付きルールを活用し、不要なルール読み込みを減らす。サブディレクトリで team 別に分割も有効。",
          "vcs": true,
          "recommended": "recommended"
        },
        {
          "path": "hooks/",
          "type": "directory",
          "name": "フックスクリプト",
          "description": "フック用スクリプト置き場（慣習的な配置場所）",
          "detail": "settings.json のフック設定から参照するスクリプトを配置する慣習的なディレクトリ。14種類のフックイベントに対応: SessionStart、UserPromptSubmit、PreToolUse、PermissionRequest、PostToolUse、PostToolUseFailure、Notification、SubagentStart、SubagentStop、Stop、TeammateIdle、TaskCompleted、PreCompact、SessionEnd。\n\n3つのフック型: command（シェルコマンド実行、async 対応）、prompt（LLM による単発評価）、agent（マルチターンのサブエージェント検証）。共通フィールド: `once`（スキル専用・セッション内1回のみ実行）、`statusMessage`（実行中スピナーメッセージ）、`timeout`（タイムアウト秒数）。各フックは stdin で JSON コンテキストを受け取り、終了コード 0 で許可、2 でブロック（イベントによってブロック挙動が異なる）。マッチャーでツール名やイベント種別をフィルタできる。SessionStart フックでは `CLAUDE_ENV_FILE` 環境変数を使って後続の Bash コマンドへ環境変数を永続化できる。スキルやエージェントのフロントマターでもフックを定義可能。",
          "usage": "例: .claude/hooks/pre-bash.sh で Bash コマンド実行前に危険なコマンドをチェック、.claude/hooks/post-write.sh でファイル書き込み後に自動フォーマットを実行。$CLAUDE_PROJECT_DIR でプロジェクトルートを参照。/hooks コマンドで対話的に管理も可能。",
          "bestPractice": "スクリプトに実行権限（chmod +x）を必ず付与する。$CLAUDE_PROJECT_DIR で相対パスを使い、チーム全員の環境で動作させる。disableAllHooks: true で一時的に全フック無効化も可能。",
          "vcs": true,
          "recommended": "optional"
        },
        {
          "path": "agent-memory/<agent-name>/",
          "type": "directory",
          "name": "エージェントメモリ（project スコープ）",
          "description": "エージェントの永続メモリ（プロジェクトスコープ）",
          "detail": "エージェントがこのプロジェクト内で会話をまたいで記憶を保持するためのディレクトリ。エージェント定義で memory: project と指定したエージェントが使用する。ユーザースコープ（~/.claude/agent-memory/）との違い: ここに保存されたメモリはこのプロジェクト専用。プロジェクト固有のコンテキスト（アーキテクチャの特徴、過去のデバッグ経験、チーム固有のパターン等）を蓄積する。",
          "usage": "VCS にコミットすると、チーム全員のエージェントが同じメモリベースを共有できる。逆に、個人的なメモリは agent-memory-local/ を使う。",
          "bestPractice": "チームで共有すべき学びを蓄積する。個人メモは agent-memory-local/ を使い分ける。VCS にコミットしてチーム全体の知見を共有する。",
          "vcs": true,
          "recommended": "optional"
        },
        {
          "path": "agent-memory-local/<agent-name>/",
          "type": "directory",
          "name": "エージェントメモリ（local スコープ）",
          "description": "エージェントの永続メモリ（ローカル専用）",
          "detail": "自動的に .gitignore に追加されるローカル専用のエージェントメモリ。エージェント定義で memory: local と指定したエージェントが使用する。個人的な作業コンテキストを保持するのに適している。チームには共有されないため、個人的な試行錯誤の記録も気兼ねなく保存できる。",
          "usage": "自分だけのデバッグ履歴、個人的な作業メモ、ローカル環境固有の情報を保存する。project スコープとの使い分け: チームで共有すべき学びは agent-memory/（project）、個人的なメモは agent-memory-local/（local）に保存する。",
          "bestPractice": "個人的な作業メモやデバッグ履歴に使い、チーム共有すべき学びは agent-memory/ に書く。定期的に不要なメモリを整理する。",
          "vcs": false,
          "recommended": "optional"
        }
      ],
      "bestPractices": [
        "rules/ は1ファイル1トピックで管理する（testing.md, api-design.md など）",
        "rules/ のサブディレクトリでグループ化可能（frontend/, backend/）",
        "paths フロントマターでファイルパス条件付きルールを定義できる（例: src/api/ 配下のファイルにのみ適用）",
        "settings.json では deny ルールを allow より先に定義する（deny → ask → allow の順で評価）"
      ]
    },
    {
      "id": "home",
      "name": "ホームディレクトリ",
      "basePath": "~/",
      "description": "ホームディレクトリ直下の設定ファイル。",
      "entries": [
        {
          "path": ".claude.json",
          "type": "file",
          "name": "ユーザー MCP 設定",
          "description": "ユーザースコープの MCP 設定・OAuth・キャッシュ",
          "detail": "ユーザーレベルの MCP サーバー設定、OAuth 認証情報、キャッシュデータなどが格納されるファイル。Claude Code が自動的に管理するため、直接編集する機会は少ない。プロジェクト横断で使いたい MCP サーバー（例: Slack 連携、GitHub 連携、ブラウザ自動化など）はここに定義する。MCP のローカルスコープ（プロジェクト固有の個人設定）もこのファイルのプロジェクトパス配下に保存される。\n\n注意: OAuth トークンなどの認証情報も含まれるため、このファイルは絶対に VCS にコミットしないこと。",
          "usage": "claude mcp add コマンドで MCP サーバーを追加すると、自動的にこのファイルが更新される。--scope user でユーザースコープ（全プロジェクト共通）、--scope local（デフォルト）でローカルスコープ（現在のプロジェクト専用）として追加される。",
          "bestPractice": "直接編集せず claude mcp add コマンドを使う。OAuth トークンを含むため絶対に VCS にコミットしない。手動編集が必要な場合はバックアップを取ってから行う。",
          "vcs": false,
          "recommended": "optional"
        }
      ],
      "bestPractices": [
        "API キーを直接ファイルにハードコードしない。apiKeyHelper スクリプトで動的認証情報を使うのが推奨"
      ]
    },
    {
      "id": "managed",
      "name": "マネージド設定（企業管理者向け）",
      "basePath": "OS 固有パス",
      "description": "企業の管理者がユーザーの設定を統制するための設定ファイル。最優先で適用され、ユーザーによるオーバーライドは不可。配置場所: macOS: /Library/Application Support/ClaudeCode/ | Linux: /etc/claude-code/ | Windows: C:\\Program Files\\ClaudeCode\\",
      "entries": [
        {
          "path": "managed-settings.json",
          "type": "file",
          "name": "マネージド設定",
          "description": "管理者が強制する設定（macOS / Linux / Windows の OS 固有パス）",
          "detail": "企業のセキュリティポリシーに基づいた設定を強制するためのファイル。設定の優先順位では最上位（レベル1）に位置し、ユーザーやプロジェクトの設定ではオーバーライドできない。配置場所は OS によって異なる: macOS は /Library/Application Support/ClaudeCode/、Linux は /etc/claude-code/、Windows は C:\\Program Files\\ClaudeCode\\。管理者専用の設定キー: allowManagedHooksOnly（ユーザー/プロジェクト/プラグインフックを禁止）、allowManagedPermissionRulesOnly（権限ルールをマネージドのみに制限）、allowedMcpServers / deniedMcpServers（MCP サーバーの許可/拒否リスト）、strictKnownMarketplaces（プラグインマーケットプレイスの許可リスト）。\n\n一般の開発者がこのファイルを作成・編集することは通常ない。企業の IT 管理者やセキュリティチームが管理する。",
          "usage": "permissions.deny で機密操作をブロックしたり、allowedMcpServers で承認済み MCP サーバーのみを許可する。MDM（モバイルデバイス管理）ツールで配布するのが一般的。allowManagedHooksOnly: true でユーザー定義フックを無効化できる。",
          "bestPractice": "MDM ツールで配布し、ユーザーの直接編集を避ける。deny ルールでセキュリティポリシーを強制し、過度に制約せず業務効率とのバランスを取る。",
          "vcs": null,
          "recommended": "advanced"
        },
        {
          "path": "managed-mcp.json",
          "type": "file",
          "name": "マネージド MCP 設定",
          "description": "管理者が強制する MCP サーバー設定",
          "detail": "企業全体で使用する MCP サーバーの設定を管理者が定義するファイル。このファイルが存在すると、MCP サーバーの排他制御が有効になり、ユーザーは独自の MCP サーバーを追加・変更できなくなる。配置場所は managed-settings.json と同じ OS 固有のパス。.mcp.json と同じ JSON 形式。\n\nallowedMcpServers / deniedMcpServers（managed-settings.json 内）と組み合わせて使うことも可能。managed-mcp.json が存在する場合でも、これらのフィルタは適用される。",
          "usage": "社内の共通ツール（内部 API ゲートウェイ、社内ドキュメント検索、監査ログ収集など）を MCP サーバーとして全社員に強制配布する。",
          "bestPractice": "apiKeyHelper で社内の秘密管理サービスから認証情報を動的取得する。API キーのハードコードは絶対に避ける。",
          "vcs": null,
          "recommended": "advanced"
        },
        {
          "path": "CLAUDE.md",
          "type": "file",
          "name": "マネージド指示ファイル",
          "description": "管理者が強制する指示ファイル",
          "detail": "企業全体のコーディング規約やセキュリティガイドラインを Claude に強制適用するファイル。ユーザーの CLAUDE.md やプロジェクトの CLAUDE.md よりも優先される。配置場所は managed-settings.json と同じ OS 固有のパス。通常は MDM や構成管理ツール（Ansible, Chef 等）で配布する。個人開発者が直接触ることはほぼない。",
          "usage": "記載例：「すべてのコードにライセンスヘッダーを付与する」「機密データ（PII）をログに出力しない」「社内ライブラリの特定バージョンを使用する」など、企業ポリシーとして全員に適用したいルールを記載する。",
          "bestPractice": "企業ポリシーとして全員に適用すべきルールのみを記載し、過度に制約しない。構成管理ツール（Ansible, Chef 等）でバージョン管理しながら配布する。",
          "vcs": null,
          "recommended": "advanced"
        }
      ],
      "bestPractices": [
        "macOS: /Library/Application Support/ClaudeCode/ に配置",
        "Linux: /etc/claude-code/ に配置",
        "Windows: C:\\Program Files\\ClaudeCode\\ に配置",
        "企業のセキュリティポリシーを一元管理し、ユーザーによるオーバーライドを防ぐ目的で使う"
      ]
    }
  ],
  "precedence": [
    { "level": 1, "name": "Managed", "description": "最優先。企業管理者が設定。オーバーライド不可。", "color": "red" },
    { "level": 2, "name": "コマンドライン引数", "description": "CLI 実行時に指定するオプション。", "color": "orange" },
    { "level": 3, "name": "Local", "description": ".claude/settings.local.json（個人×プロジェクト）", "color": "yellow" },
    { "level": 4, "name": "Project", "description": ".claude/settings.json（チーム共有）", "color": "green" },
    { "level": 5, "name": "User", "description": "~/.claude/settings.json（全プロジェクト共通の個人設定）", "color": "blue" }
  ],
  "commitGuide": {
    "commit": [
      "CLAUDE.md（プロジェクトルート）",
      ".claude/settings.json",
      ".mcp.json",
      ".claude/commands/",
      ".claude/agents/",
      ".claude/skills/",
      ".claude/rules/",
      ".claude/hooks/",
      ".claude/agent-memory/"
    ],
    "noCommit": [
      "settings.local.json（自動 gitignore）",
      "CLAUDE.local.md（自動 gitignore）",
      "agent-memory-local/（自動 gitignore）",
      "~/.claude/ 配下すべて（個人設定）",
      "~/.claude.json（個人 MCP 設定・OAuth トークン含む）"
    ]
  },
  "skillsVsAgents": {
    "skills": {
      "description": "再利用可能なプロンプト・ワークフロー",
      "characteristics": [
        "SKILL.md + 補助ファイルで構成（Agent Skills 標準準拠）",
        "context: fork でサブエージェントとして独立実行可能",
        "ユーザーが /skill-name で呼び出し、または Claude が自動検出",
        "フロントマターで hooks / allowed-tools / model を設定可能",
        "$ARGUMENTS で引数、!`command` で動的コンテキスト注入",
        "disable-model-invocation で手動専用に制限可能"
      ]
    },
    "agents": {
      "description": "独立したコンテキストで動く特化型 AI",
      "characteristics": [
        "tools / disallowedTools でツール制限、permissionMode で権限設定",
        "Claude が Task ツールから自動的に委譲、または明示的に指定",
        "独立したコンテキストウィンドウで動作（フォアグラウンド/バックグラウンド）",
        "memory（user / project / local）で会話をまたいだ学習が可能",
        "skills フィールドでスキルをプリロード可能",
        "hooks / mcpServers でエージェント固有のフック・ツールを定義"
      ]
    }
  }
}
